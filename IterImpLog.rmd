library(caret)
set.seed(1234)
cv_err = rep(NA, 10)

folds = createFolds(1:nrow(data_imp), k=10, list=F)
for (i in 1:10){
  k_ind = (fold == i)
  train = data_imp[!k_ind, ]
  test = data_imp[k_ind, ]
  log_mod <- glm(HeartDiseaseorAttack ~., data = train, family = "binomial")
  log_mod_stepped <- step(log_mod, direction = "both")
  print(log_mod_stepped$coefficients)
  p_Heart <- ifelse(predict(log_mod_stepped, test, type = "response") > 0.5, 1, 0)
  err = mean(p_Heart != test$HeartDiseaseorAttack)
  cv_err[i] = err
}
mean(cv_err)
